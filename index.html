<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mike's Workout Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: white;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .exercise-selector {
            margin-bottom: 20px;
        }

        .exercise-selector label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #555;
        }

        .exercise-selector select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            background: white;
            transition: border-color 0.3s;
        }

        .exercise-selector select:focus {
            outline: none;
            border-color: #667eea;
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            color: white;
        }

        .stat-card h3 {
            font-size: 0.9em;
            margin-bottom: 5px;
            opacity: 0.9;
        }

        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
        }

        .workout-input {
            margin-bottom: 25px;
        }

        .workout-input label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #555;
        }

        .workout-input input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 18px;
            text-align: center;
            transition: border-color 0.3s;
        }

        .workout-input input:focus {
            outline: none;
            border-color: #667eea;
        }

        .button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-bottom: 15px;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .button:active {
            transform: translateY(0);
        }

        .add-exercise-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .chart-container {
            height: 300px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .history-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-item .date {
            font-weight: 600;
            color: #666;
        }

        .history-item .reps {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: 15px;
            max-width: 400px;
            width: 90%;
        }

        .modal-content h3 {
            margin-bottom: 20px;
            color: #333;
        }

        .modal-content input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
        }

        .cancel-btn {
            background: #e0e0e0;
            color: #666;
        }

        .confirm-btn {
            background: #667eea;
            color: white;
        }

        .tab-buttons {
            display: flex;
            background: #f0f0f0;
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 20px;
        }

        .tab-button {
            flex: 1;
            padding: 15px;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }

        .tab-button.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .no-data {
            text-align: center;
            color: #666;
            padding: 40px;
            font-style: italic;
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ’ª Mike's Workout Tracker</h1>
        </div>

        <div class="card">
            <div class="exercise-selector">
                <label for="exercise-select">Select Exercise:</label>
                <select id="exercise-select">
                    <option value="pushups">Push-ups</option>
                </select>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <h3>Last Workout</h3>
                    <div class="value" id="last-reps">0</div>
                </div>
                <div class="stat-card">
                    <h3>Average Reps</h3>
                    <div class="value" id="avg-reps">0</div>
                </div>
            </div>

            <div class="workout-input">
                <label for="reps-input">Reps Completed:</label>
                <input type="number" id="reps-input" placeholder="Enter reps" min="0">
            </div>

            <button class="button" onclick="logWorkout()">Log Workout</button>
            <button class="button add-exercise-btn" onclick="showAddExerciseModal()">Add New Exercise</button>
            
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button class="button" style="flex: 1; background: linear-gradient(135deg, #28a745 0%, #20c997 100%);" onclick="exportData()">ðŸ“¤ Export Data</button>
                <button class="button" style="flex: 1; background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);" onclick="document.getElementById('import-file').click()">ðŸ“¥ Import Data</button>
            </div>
            <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importData(event)">
        </div>

        <div class="card">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="showTab('history')">History</button>
                <button class="tab-button" onclick="showTab('progress')">Progress</button>
            </div>

            <div id="history-tab" class="tab-content active">
                <div id="workout-history"></div>
            </div>

            <div id="progress-tab" class="tab-content">
                <div class="chart-container">
                    <canvas id="progress-chart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Exercise Modal -->
    <div id="add-exercise-modal" class="modal">
        <div class="modal-content">
            <h3>Add New Exercise</h3>
            <input type="text" id="new-exercise-name" placeholder="Exercise name (e.g., Pull-ups)">
            <div class="modal-buttons">
                <button class="cancel-btn" onclick="hideAddExerciseModal()">Cancel</button>
                <button class="confirm-btn" onclick="addNewExercise()">Add</button>
            </div>
        </div>
    </div>

    <!-- Import Confirmation Modal -->
    <div id="import-modal" class="modal">
        <div class="modal-content">
            <h3>Import Data</h3>
            <p id="import-message">This will replace all your current workout data. Are you sure?</p>
            <div class="modal-buttons">
                <button class="cancel-btn" onclick="hideImportModal()">Cancel</button>
                <button class="confirm-btn" onclick="confirmImport()">Import</button>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let exercises = JSON.parse(localStorage.getItem('exercises')) || ['pushups'];
        let workoutData = JSON.parse(localStorage.getItem('workoutData')) || {};
        let importedData = null; // Store data to import

        // Initialize workout data for existing exercises
        exercises.forEach(exercise => {
            if (!workoutData[exercise]) {
                workoutData[exercise] = [];
            }
        });

        let currentExercise = 'pushups';
        let progressChart = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            populateExerciseSelector();
            updateStats();
            displayWorkoutHistory();
            initializeChart();
        });

        function populateExerciseSelector() {
            const selector = document.getElementById('exercise-select');
            selector.innerHTML = '';
            
            exercises.forEach(exercise => {
                const option = document.createElement('option');
                option.value = exercise;
                option.textContent = exercise.charAt(0).toUpperCase() + exercise.slice(1);
                selector.appendChild(option);
            });

            selector.addEventListener('change', function() {
                currentExercise = this.value;
                updateStats();
                displayWorkoutHistory();
                updateChart();
            });
        }

        function updateStats() {
            const data = workoutData[currentExercise] || [];
            const lastRepsEl = document.getElementById('last-reps');
            const avgRepsEl = document.getElementById('avg-reps');

            if (data.length > 0) {
                const lastWorkout = data[data.length - 1];
                lastRepsEl.textContent = lastWorkout.reps;

                const avgReps = Math.round(data.reduce((sum, workout) => sum + workout.reps, 0) / data.length);
                avgRepsEl.textContent = avgReps;
            } else {
                lastRepsEl.textContent = '0';
                avgRepsEl.textContent = '0';
            }
        }

        function logWorkout() {
            const repsInput = document.getElementById('reps-input');
            const reps = parseInt(repsInput.value);

            if (!reps || reps <= 0) {
                alert('Please enter a valid number of reps');
                return;
            }

            const workout = {
                date: new Date().toISOString(),
                reps: reps,
                exercise: currentExercise
            };

            if (!workoutData[currentExercise]) {
                workoutData[currentExercise] = [];
            }

            workoutData[currentExercise].push(workout);
            localStorage.setItem('workoutData', JSON.stringify(workoutData));

            repsInput.value = '';
            updateStats();
            displayWorkoutHistory();
            updateChart();

            // Show success feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Logged! ðŸŽ‰';
            button.style.background = 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)';
            setTimeout(() => {
                button.textContent = originalText;
                button.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            }, 2000);
        }

        function displayWorkoutHistory() {
            const historyContainer = document.getElementById('workout-history');
            const data = workoutData[currentExercise] || [];

            if (data.length === 0) {
                historyContainer.innerHTML = '<div class="no-data">No workouts recorded yet. Start your first workout!</div>';
                return;
            }

            const sortedData = [...data].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            historyContainer.innerHTML = sortedData.map(workout => {
                const date = new Date(workout.date);
                const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                return `
                    <div class="history-item">
                        <div class="date">${formattedDate}</div>
                        <div class="reps">${workout.reps} reps</div>
                    </div>
                `;
            }).join('');
        }

        function showAddExerciseModal() {
            document.getElementById('add-exercise-modal').style.display = 'block';
        }

        function hideAddExerciseModal() {
            document.getElementById('add-exercise-modal').style.display = 'none';
            document.getElementById('new-exercise-name').value = '';
        }

        function addNewExercise() {
            const exerciseName = document.getElementById('new-exercise-name').value.trim().toLowerCase();
            
            if (!exerciseName) {
                alert('Please enter an exercise name');
                return;
            }

            if (exercises.includes(exerciseName)) {
                alert('Exercise already exists');
                return;
            }

            exercises.push(exerciseName);
            workoutData[exerciseName] = [];
            
            localStorage.setItem('exercises', JSON.stringify(exercises));
            localStorage.setItem('workoutData', JSON.stringify(workoutData));
            
            populateExerciseSelector();
            hideAddExerciseModal();
        }

        function showTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + '-tab').classList.add('active');

            if (tabName === 'progress') {
                updateChart();
            }
        }

        function initializeChart() {
            const canvas = document.getElementById('progress-chart');
            const ctx = canvas.getContext('2d');
            
            // Simple chart implementation
            updateChart();
        }

        function updateChart() {
            const canvas = document.getElementById('progress-chart');
            const ctx = canvas.getContext('2d');
            const data = workoutData[currentExercise] || [];

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (data.length === 0) {
                ctx.fillStyle = '#666';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('No data to display', canvas.width / 2, canvas.height / 2);
                return;
            }

            // Set canvas size
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;

            const padding = 40;
            const chartWidth = canvas.width - 2 * padding;
            const chartHeight = canvas.height - 2 * padding;

            // Get max reps for scaling
            const maxReps = Math.max(...data.map(d => d.reps));
            const minReps = Math.min(...data.map(d => d.reps));
            const repsRange = maxReps - minReps || 1;

            // Draw axes
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, padding + chartHeight);
            ctx.lineTo(padding + chartWidth, padding + chartHeight);
            ctx.stroke();

            // Draw data points and lines
            if (data.length > 1) {
                ctx.strokeStyle = '#667eea';
                ctx.lineWidth = 2;
                ctx.beginPath();

                data.forEach((workout, index) => {
                    const x = padding + (index / (data.length - 1)) * chartWidth;
                    const y = padding + chartHeight - ((workout.reps - minReps) / repsRange) * chartHeight;
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                ctx.stroke();
            }

            // Draw data points
            ctx.fillStyle = '#667eea';
            data.forEach((workout, index) => {
                const x = padding + (index / Math.max(data.length - 1, 1)) * chartWidth;
                const y = padding + chartHeight - ((workout.reps - minReps) / repsRange) * chartHeight;
                
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fill();
            });

            // Draw labels
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            
            // Y-axis labels
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = minReps + (repsRange * i / 5);
                const y = padding + chartHeight - (i / 5) * chartHeight;
                ctx.fillText(Math.round(value), padding - 10, y + 4);
            }

            // Title
            ctx.fillStyle = '#333';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`${currentExercise.charAt(0).toUpperCase() + currentExercise.slice(1)} Progress`, canvas.width / 2, 25);
        }

        // Export/Import Functions
        function exportData() {
            const exportObj = {
                exercises: exercises,
                workoutData: workoutData,
                exportDate: new Date().toISOString(),
                version: "1.0"
            };

            const dataStr = JSON.stringify(exportObj, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `workout-data-${new Date().toISOString().split('T')[0]}.json`;
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            // Show success message
            alert('Data exported successfully! ðŸ“¤\n\nSave this file somewhere safe as a backup.');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Validate the data structure
                    if (!data.exercises || !data.workoutData) {
                        alert('Invalid file format. Please select a valid workout data export file.');
                        return;
                    }

                    importedData = data;
                    
                    // Show confirmation modal with preview
                    const totalWorkouts = Object.values(data.workoutData).reduce((sum, workouts) => sum + workouts.length, 0);
                    const exportDate = data.exportDate ? new Date(data.exportDate).toLocaleDateString() : 'Unknown';
                    
                    document.getElementById('import-message').innerHTML = `
                        <strong>Import Preview:</strong><br>
                        â€¢ ${data.exercises.length} exercises<br>
                        â€¢ ${totalWorkouts} total workouts<br>
                        â€¢ Export date: ${exportDate}<br><br>
                        This will replace all your current data. Continue?
                    `;
                    
                    document.getElementById('import-modal').style.display = 'block';
                    
                } catch (error) {
                    alert('Error reading file. Please make sure it\'s a valid JSON export file.');
                }
            };
            
            reader.readAsText(file);
            // Clear the input so same file can be selected again
            event.target.value = '';
        }

        function hideImportModal() {
            document.getElementById('import-modal').style.display = 'none';
            importedData = null;
        }

        function confirmImport() {
            if (!importedData) return;

            try {
                exercises = importedData.exercises;
                workoutData = importedData.workoutData;
                
                // Save to localStorage
                localStorage.setItem('exercises', JSON.stringify(exercises));
                localStorage.setItem('workoutData', JSON.stringify(workoutData));
                
                // Update UI
                populateExerciseSelector();
                updateStats();
                displayWorkoutHistory();
                updateChart();
                
                hideImportModal();
                alert('Data imported successfully! ðŸ“¥\n\nAll your exercises and workout history have been restored.');
                
            } catch (error) {
                alert('Error importing data. Please try again or contact support.');
            }
        }

        // Handle modal clicks
        document.getElementById('add-exercise-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideAddExerciseModal();
            }
        });

        document.getElementById('import-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideImportModal();
            }
        });

        // Handle Enter key in input fields
        document.getElementById('reps-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                logWorkout();
            }
        });

        document.getElementById('new-exercise-name').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addNewExercise();
            }
        });
    </script>
</body>
</html>
